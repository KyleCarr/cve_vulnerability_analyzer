# CVE Vulnerability Analyzer

The CVE Vulnerability Analyzer is an advanced Rust Command-Line Interface (CLI) tool designed for local analysis of the Common Vulnerabilities and Exposures (CVE) Mitre database. This tool empowers users to conduct thorough assessments of potential vulnerabilities within their systems, providing a comprehensive view of the security landscape.
# Table of Contents
- [CVE Vulnerability Analyzer](#cve-vulnerability-analyzer)
- [Table of Contents](#table-of-contents)
- [Features](#features)
- [Installation](#installation)
  - [Linux](#linux)
  - [Windows](#windows)
  - [Database Viewing](#viewing-the-database)
- [Usage](#usage)
  - [Commands](#commands)
- [License](#license)
## Features
**Local Analysis:** Perform in-depth analysis of CVE data directly on your machine, ensuring efficiency and security. <br>
**CVE Mitre Database:** Access and leverage the extensive CVE Mitre database to stay informed about known vulnerabilities. <br>
**Rust Powered:** Built with Rust, the CVE Vulnerability Analyzer offers robust performance and reliability. <br>
**Command-Line Interface:** The CVE Vulnerability Analyzer is a command-line tool, allowing for quick and easy access to the CVE Mitre database. <br>

## Installation
## Linux
#### This was tested using POP!_OS 22.04 LTS
### Install Rust
Open a terminal and run the following commands:
- `sudo apt install build-essential`
- `curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh`
- `source $HOME/.cargo/env`
- `rustup install stable`
- `rustup default stable`
- `rustup update`
### Install dependencies
- `sudo apt install libssl-dev`
- `sudo apt install pkg-config`
- `sudo apt install libudev-dev`
- `sudo apt install libsqlite3-dev`
- `sudo apt install libdbus`
### install docker
#### Installation
- `sudo apt install docker.io`
- `sudo systemctl start docker`
- `sudo systemctl enable docker`
- `sudo systemctl status docker`
- `sudo usermod -aG docker $USER`
- `su - $USER`
- `id -nG`
#### Config
![img.png](img.png) <br>
Dockerfile: `src/config/Dockerfile` <br>
Bind ports: `5432:5432` <br>
Verify that these values are also matching in the /config/config.json file
<br> Run
### Configure Diesel
- `cargo install diesel_cli --no-default-features --features postgres`
- `echo DATABASE_URL=postgres://docker:password@localhost/postgresdb >.env` 
  - *Note: these are the default credentials present in the Dockerfile. change them as needed*
- `diesel setup`
- `diesel migration run`  
  - *Note: If there are issues with the database, you can reset it via the changelogs by running `diesel migration redo`*
### Run the program
- `cargo run`
- `cargo run --release`


## Windows
#### This was tested using A Windows 10 Virtual machine
### Install Ubuntu through WSL
Open a powershell terminal and run the following commands:
- `wsl --install`
- `wsl --set-default-version 2`
- `wsl --list --verbose`
- `wsl --set-version Ubuntu-20.04 2`
- `wsl -d Ubuntu-20.04`
- `sudo apt update`
- `sudo apt upgrade`
### Install Rust
Open a terminal and run the following commands:
- `sudo apt install build-essential`
- `curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh`
- `source $HOME/.cargo/env`
- `rustup install stable`
- `rustup default stable`
- `rustup update`
### Install dependencies
- `sudo apt install libssl-dev`
- `sudo apt install pkg-config`
- `sudo apt install libudev-dev`
- `sudo apt install libsqlite3-dev`
- `sudo apt install libdbus`
### Install Docker
#### Installation
- `sudo apt install docker.io`
- `sudo systemctl start docker`
- `sudo systemctl enable docker`
- `sudo systemctl status docker`
- `sudo usermod -aG docker $USER`
- `su - $USER`
- `id -nG`
#### Config
![img_1.png](img_1.png) <br>
Dockerfile: `src/config/Dockerfile` <br>
Bind ports: `8080:5432` <br>*Note: This port is different from the linux setup because of the nature of WSL.*
<br> Verify that these values are also matching in the /config/config.json file
### Configure Diesel
- `cargo install diesel_cli --no-default-features --features postgres`
- `echo DATABASE_URL=postgres://docker:password@localhost/postgresdb >.env` 
  - *Note: These are the default credentials present in the Dockerfile. Change them as needed*
- `diesel setup`
  `diesel migration run` 
  - *Note: If there are issues with the database, you can reset it via the changelogs by running `diesel migration redo`*
### Run the program
- `cargo run`
- `cargo run --release`
## Viewing the database
### Dbeaver was used to view the database
![img_2.png](img_2.png) <br>
Host: `localhost` <br>
Port: *If Linux:* `5432` *If Windows:* `8080` <br>
Database: `postgresdb` <br>
Username: `docker` <br>
Password: `password` <br>*Note: These are the default credentials present in the Dockerfile. Change them as needed*
## Usage
### Commands
- `help`  Displays the list of available commands
- `search [-p parameter] [-y year]` Searches the database for a specific CVE
   - `-p`  Adds a keyword based search. i.e -p java returns all CVE records containing the keyword Java
   - `-y`  Adds a year based search. i.e -y 2023 returns all records from 2023
- `sync` Downloads the latest CVE records and adds them to the postgres database **Note: This takes a while**
- `export` Exports the last search result into a CSV file
- `examine Arg[0]` Examines the cve record provided, listing more details about the vulnerability
- `exit` quits the program
## License
Copyright [2023] [Kyle Carr]

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.